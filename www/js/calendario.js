function CalendarioPeriodico(e,t,i,a){this.contenedor=e,this.fecha_inicio=t,this.fecha_termino=i,this.nombre_clase=a,this.cargarCalendario=function(e,t){var i=this,a="mostrar_calendario_periodico",n=document.form_principal.objeto_id.value;dojo.xhrPost({url:"calendario.php?accion="+a+"&nombre_clase="+this.nombre_clase+"&objeto_id="+n+"&fecha_inicio_periodo="+e+"&fecha_termino_periodo="+t+"&ajax=1",load:function(e){return"LOGOUT"===e.trim()?void logout():(document.getElementById(i.contenedor).innerHTML=e,i.fecha_inicio=document.getElementById("fecha_inicio_periodico").value,i.fecha_termino=document.getElementById("fecha_termino_periodico").value,void i.setRangoCalendario(1))}})},this.seleccionarPeriodo=function(e,t){this.setRangoCalendario(0),this.setFechaInicio(e),this.setFechaTermino(t),this.setRangoCalendario(1)},this.seleccionarDia=function(e){var t=e.split("|");this.setRangoCalendario(0),this.setFechaInicio(t[1]),this.setFechaTermino(t[1]),this.setRangoCalendario(1)},this.seleccionarSemana=function(e){var t=e.split("|"),i=t[1],a=i.split("-"),n=new Date(a[0],parseInt(a[1],10)-1,parseInt(a[2],10)+6);this.setRangoCalendario(0),this.setFechaInicio(i),this.setFechaTermino(this.getDateToString(n)),this.setRangoCalendario(1)},this.setRangoCalendario=function(e){0==e?document.getElementById("periodo|"+this.fecha_inicio+"_"+this.fecha_termino)&&(document.getElementById("periodo|"+this.fecha_inicio+"_"+this.fecha_termino).style.backgroundColor="#ffffff"):document.getElementById("periodo|"+this.fecha_inicio+"_"+this.fecha_termino)&&(document.getElementById("periodo|"+this.fecha_inicio+"_"+this.fecha_termino).style.backgroundColor="#f7af72");for(var t=this.getStringToDate(this.fecha_inicio),i=this.getStringToDate(this.fecha_inicio),a=i.getDate()+1;t<=this.getStringToDate(this.fecha_termino);a++)document.getElementById("dia|"+this.getDateToString(t))&&(0==e?document.getElementById("dia|"+this.getDateToString(t)).style.backgroundColor="#ffffff":document.getElementById("dia|"+this.getDateToString(t)).style.backgroundColor="#f7af72"),t=new Date(i.getFullYear(),i.getMonth(),a)},this.setFechaInicio=function(e){this.fecha_inicio=e,document.getElementById("fecha_inicio_periodico").value=e},this.setFechaTermino=function(e){this.fecha_termino=e,document.getElementById("fecha_termino_periodico").value=e},this.getStringToDate=function(e){var t=e.split("-"),i=new Date(t[0],parseInt(t[1],10)-1,t[2]);return i},this.getDateToString=function(e){var t,i;t=e.getUTCDate()<10?"0"+e.getUTCDate():e.getUTCDate(),i=parseInt(e.getMonth(),10)+1<10?"0"+(parseInt(e.getMonth(),10)+1):parseInt(e.getMonth(),10)+1;var a=e.getFullYear()+"-"+i+"-"+t;return a},this.cargarCalendario(t,i)}function Calendario(e,t,i,a){this.contenedor=e,this.fecha_inicio=t,this.fecha_termino=i,this.nombre_clase=a,this.dia_default=1,this.cargarCalendario=function(e){var t=document.form_principal.objeto_id.value,i=this;dojo.xhrPost({url:"calendario.php?fecha_mostrada="+e+"&nombre_clase="+this.nombre_clase+"&objeto_id="+t+"&ajax=1",load:function(e){return"LOGOUT"===e.trim()?void logout():(document.getElementById(i.contenedor).innerHTML=e,i.setFechaInicio(i.fecha_inicio),i.setFechaTermino(i.fecha_termino),void i.setRangoCalendario(1))}})},this.seleccionarDia=function(e){var t=e.split("|"),i=t[1];1==this.dia_default?(this.dia_default=0,this.setRangoCalendario(0),this.setFechaInicio(i),this.setFechaTermino(i),this.setRangoCalendario(1)):this.fecha_inicio==this.fecha_termino?(this.getStringToDate(i)<this.getStringToDate(this.fecha_inicio)?this.setFechaInicio(i):this.setFechaTermino(i),this.setRangoCalendario(1)):(this.setRangoCalendario(0),this.setFechaInicio(i),this.setFechaTermino(i),this.setRangoCalendario(1))},this.seleccionarSemana=function(e){var t=e.split("|"),i=t[1],a=i.split("-"),n=new Date(a[0],parseInt(a[1],10)-1,parseInt(a[2],10)+6);this.setRangoCalendario(0),this.setFechaInicio(i),this.setFechaTermino(this.getDateToString(n)),this.setRangoCalendario(1)},this.seleccionarMes=function(e){var t=e.split("|"),i=t[1],a=i.split("-"),n=new Date(a[0],parseInt(a[1],10),parseInt(a[2],10)-1);this.setRangoCalendario(0),this.setFechaInicio(i),this.setFechaTermino(this.getDateToString(n)),this.setRangoCalendario(1)},this.seleccionarInput=function(){var e=/^\d{1,2}\/\d{1,2}\/\d{2,4}$/,t=document.getElementById("fecha_inicio_sel").value,i=document.getElementById("fecha_termino_sel").value,a=t.split("/"),n=i.split("/"),o=this.getStringToDate(a[2]+"-"+a[1]+"-"+a[0]),s=this.getStringToDate(n[2]+"-"+n[1]+"-"+n[0]),r=new Date,c=new Date(r.getFullYear(),r.getMonth()-6,1);document.getElementById("fecha_inicio_sel").value=this.getFormatoFecha(this.fecha_inicio),document.getElementById("fecha_termino_sel").value=this.getFormatoFecha(this.fecha_termino),t.match(e)&&i.match(e)?o>s?alert("La fecha de inicio no puede ser mayor que la fecha de termino."):o>r||s>r?alert("El rango de busqueda no puede superar la fecha actual."):c>o||c>s?alert("El rango de busqueda no puede ser anterior a 6 meses."):(this.setRangoCalendario(0),this.setFechaInicio(this.getDateToString(o)),this.setFechaTermino(this.getDateToString(s)),this.setRangoCalendario(1)):alert("Las fechas estan mal ingresadas.")},this.setRangoCalendario=function(e){for(var t=this.getStringToDate(this.fecha_inicio),i=this.getStringToDate(this.fecha_inicio),a=i.getDate()+1;t<=this.getStringToDate(this.fecha_termino);a++)document.getElementById("dia|"+this.getDateToString(t))&&(0==e?document.getElementById("dia|"+this.getDateToString(t)).style.backgroundColor="#ffffff":document.getElementById("dia|"+this.getDateToString(t)).style.backgroundColor="#f7af72"),t=new Date(i.getFullYear(),i.getMonth(),a)},this.setFechaInicio=function(e){this.fecha_inicio=e,document.getElementById("fecha_inicio").value=e,document.getElementById("fecha_inicio_sel").value=this.getFormatoFecha(e)},this.setFechaTermino=function(e){var t=this.fecha_inicio.split("-"),i=new Date(t[0],parseInt(t[1],10)+2,t[2]);this.getStringToDate(e)>i&&(alert("El rango de busqueda no puedo superar los 3 meses."),e=this.fecha_inicio),this.fecha_termino=e,document.getElementById("fecha_termino").value=e,document.getElementById("fecha_termino_sel").value=this.getFormatoFecha(e)},this.getStringToDate=function(e){var t=e.split("-"),i=new Date(t[0],parseInt(t[1],10)-1,t[2]);return i},this.getDateToString=function(e){var t,i;t=e.getUTCDate()<10?"0"+e.getUTCDate():e.getUTCDate(),i=parseInt(e.getMonth(),10)+1<10?"0"+(parseInt(e.getMonth(),10)+1):parseInt(e.getMonth(),10)+1;var a=e.getFullYear()+"-"+i+"-"+t;return a},this.getFormatoFecha=function(e){var t,i,a=e.split("-");return t=parseInt(a[2],10)<10?"0"+parseInt(a[2],10):parseInt(a[2],10),i=parseInt(a[1],10)<10?"0"+parseInt(a[1],10):parseInt(a[1]),t+"/"+i+"/"+a[0]},this.cargarCalendario(i)}